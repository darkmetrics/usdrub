library(tidyverse)
library(gridExtra) # Arrangning ggplots
library(readr)     # Loading data
library(readxl)    # Loading excel
library(forecast)
setwd('D:/Users/Vladimir/Desktop/Github/usdrub/code')
```{r, results='hide', message=FALSE, warning=FALSE, echo=FALSE}
library(tidyverse)
library(gridExtra) # Arrangning ggplots
library(readr)     # Loading data
library(readxl)    # Loading excel
library(forecast)
setwd('D:/Users/Vladimir/Desktop/Github/usdrub/code')
t <- data.frame(read_excel('data/terrorism.xls'))
getwd()
setwd('D:/Users/Vladimir/Desktop/Github/usdrub/code')
t <- data.frame(read_excel('data/terrorism.xls'))
getwd()
t <- data.frame(read_excel('data/terrorism.xls'))
glimpse(t)
t <- data.frame(read_excel('data/terrorism.xls'))
t$ENTRY <- as.Date(t$ENTRY, format='%Y-%m-%d %h-%m-%s'))
t <- data.frame(read_excel('data/terrorism.xls'))
t$ENTRY <- as.Date(t$ENTRY, format='%Y-%m-%d %h-%m-%s')
glimpse(t)
install.packages(TSstudio)
install.packages("TSstudio")
# t[c(ENTRY, Domestic)]
t[c(ENTRY, Domestic)]
select(t, c(ENTRY, Domestic))
library(TSstudio) # симпатичные графики
t <- data.frame(read_excel('data/terrorism.xls'))
t$ENTRY <- as.Date(t$ENTRY, format='%Y-%m-%d %h-%m-%s')
glimpse(t)
ts_plot(select(t, c(ENTRY, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t$ENTRY <- as.Date(t$ENTRY, format='%Y-%m-%d')
glimpse(t)
ts_plot(select(t, c(ENTRY, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t <- data.frame(read_excel('data/terrorism.xls'))
glimpse(t)
library(zoo)
new_date <- as.yearqtr(t$ENTRY)
new_date
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
t['date'] <- as.yearqtr(t$ENTRY)
glimpe(t)
glimpse(t)
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
t['date'] <- as.yearqtr(t$date)
glimpse(t)
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, -ENTRY)
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, -c(ENTRY))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
t['date'] <- as.yearqtr(t$date)
t$ENTRY <- as.Date(t$ENTRY, format='%Y-%m-%d')
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
t['date'] <- as.yearqtr(t$date)
glimpse(t)
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
dom <- ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
trans <- ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
grid.arrange(trans, dom, nrow = 2)
grid.arrange(trans, dom, nrow = 2, ncol=1)
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
dom <- ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
trans <- ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
grid.arrange(grobs=list(trans, dom), nrow = 2, ncol=1)
dom <- ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
trans <- ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
par(mfrow = c(2, 1))
dom <- ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
trans <- ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
par(mfrow = c(, 1))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
par(mfrow = c(2, 1))
dom <- ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
trans <- ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
par(mfrow = c(1, 1))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
par(mfrow = c(2, 1))
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
par(mfrow = c(1, 1))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
select(t, c(date, Domestic)
q
select(t, c(date, Domestic))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
head(t, 10)
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
head(t, 10)
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
head(t, 10)
# t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
head(t, 10)
t['date'] <- as.yearqtr(t$date)
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# zoo
t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# zoo
t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
par(mfrow = c(2, 1))
ts_plot(select(t, c(date, Domestic)),
title = "Локальный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
ts_plot(select(t, c(date, Transnational)),
title = "Международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
par(mfrow = c(1, 1))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# zoo
t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic, Transnational)),
title = "Локальный и международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers")
par(mfrow = c(1, 1))
t <- data.frame(read_excel('data/terrorism.xls'))
t <- subset(t, select =-c(ENTRY))
t['date'] <- seq(1970,by=0.25,length.out=nrow(t))
# zoo
t['date'] <- as.yearqtr(t$date)
t['date'] <- as.Date(t$date, format='%Y-%q')
glimpse(t)
ts_plot(select(t, c(date, Domestic, Transnational)),
title = "Локальный и международный терроризм",
Xtitle = "Время",
Ytitle = "Терактов за квартал",
line.mode =  "lines+markers",
type = 'multiple')
par(mfrow = c(1, 1))
glimpse(t)
view(t)
t['1988-10-01']
t['1988-10-01']
t[,'1988-10-01']
t['1988-10-01', ]
view(t)
t[as.Date('1988-10-01'), ]
t[as.Date('1988-10-01', format='%Y-%q'), ]
t[t$date=as.Date('1988-10-01', format='%Y-%q'), ]
t[as.Date('1988-10-01', format='%Y-%q'), ]
t[date=as.Date('1988-10-01', format='%Y-%q'), ]
t[t$date==as.Date('1988-10-01', format='%Y-%q'), ]
head(t[t$date==as.Date('1988-10-01', format='%Y-%q'), ], 10)
head(t[t$date=='1988-10-01', ], 10)
head(t[t$date<='1988-10-01', ], 10)
t[t$date<='1988-10-01', ]
ind <- whicht(t[t$date=='1977-01-01', ])
ind <- which(t[t$date=='1977-01-01', ])
ind <- which(t[t$date=='1977-01-01'])
ind <- which(t$date=='1977-01-01')
ind
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1977-01-01')
sub$jump <- 1
sub$jump[1:ind] <- 0
view(sub)
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1977-01-01')
sub$jump <- 1
sub$jump[1:(ind-1)] <- 0
arima_jump <- auto.arima(sub$Transnational,xreg=sub$jump,ic="bic")
summary(arima_jump)
# оценим модель
arima_jump <- auto.arima(sub$Transnational,xreg=sub$jump")
# оценим модель
arima_jump <- auto.arima(sub$Transnational,xreg=sub$jump)
summary(arima_jump)
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1977-01-01')
sub$jump <- 1
sub$jump[1:(ind-1)] <- 0
arima_jump <- auto.arima(sub$Transnational,xreg=sub$jump)
summary(arima_jump)
# оценим модель
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1977-01-01')
sub$jump <- 1
sub$jump[1:(ind-1)] <- 0
arima_jump <- auto.arima(sub$Transnational,xreg=sub$jump)
summary(arima_jump)
# оценим модель
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1977-01-01')
sub$jump <- 1
sub$jump[1:(ind-1)] <- 0
arima_jump_t <- auto.arima(sub$Transnational,xreg=sub$jump, ic='bic')
summary(arima_jump)
# оценим модель
view(sub)
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1973-01-01')
sub$jump <- 1
sub$jump[1:(ind-1)] <- 0
arima_jump_t <- auto.arima(sub$Transnational,xreg=sub$jump, ic='bic')
summary(arima_jump)
# оценим модель
view(sub)
sub <-  t[t$date<='1988-10-01', ]
# создадим третий временной ряд
sub$Other <- sub$Transnational - sub$Domestic
# добавим дамми
ind <- which(sub$date=='1973-01-01')
sub$jump <- 1
sub$jump[1:(ind-1)] <- 0
arima_jump_t <- auto.arima(sub$Domestic,xreg=sub$jump, ic='bic')
summary(arima_jump)
# оценим модель
